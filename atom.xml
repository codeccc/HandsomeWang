<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>傻逼魅族手机</title>
  <subtitle>魅族这种烂手机,傻逼,...</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://codewang.site/"/>
  <updated>2017-07-31T07:20:27.368Z</updated>
  <id>http://codewang.site/</id>
  
  <author>
    <name>樱花洛</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://codewang.site/Android%E5%9F%BA%E4%BA%8EX5%E5%86%85%E6%A0%B8%20WebView%E9%A1%B9%E7%9B%AE%E5%A5%97%E5%A3%B3%E4%BC%98%E5%8C%96.html"/>
    <id>http://codewang.site/Android基于X5内核 WebView项目套壳优化.html</id>
    <published>2017-07-31T07:19:54.397Z</published>
    <updated>2017-07-31T07:20:27.368Z</updated>
    
    <content type="html"><![CDATA[<h5 id="一、webview加载缓慢-如何提高加载使用效率"><a href="#一、webview加载缓慢-如何提高加载使用效率" class="headerlink" title="一、webview加载缓慢,如何提高加载使用效率?"></a>一、webview加载缓慢,如何提高加载使用效率?</h5><ol>
<li><p>设置渲染等级为高</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">settings.setRenderPriority(WebSettings.RenderPriority.HIGH);</div></pre></td></tr></table></figure>
</li>
<li><p>在java代码中动态创建webview</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">WebView webView = <span class="keyword">new</span> WebView(getApplicationContext(), <span class="keyword">null</span>);</div><div class="line">webView.setLayoutParams(<span class="keyword">new</span> ViewGroup.LayoutParams(FrameLayout.LayoutParams.MATCH_PARENT, FrameLayout.LayoutParams.MATCH_PARENT));</div><div class="line">mBinding.mainView.addView(webView, <span class="number">0</span>);</div></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="二、Webview缓存使用策略"><a href="#二、Webview缓存使用策略" class="headerlink" title="二、Webview缓存使用策略"></a>二、Webview缓存使用策略</h5><p>webview的五种缓存策略模式:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LOAD_DEFAULT = -<span class="number">1</span>;<span class="comment">//默认模式</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LOAD_NORMAL = <span class="number">0</span>;<span class="comment">//普通模式</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LOAD_CACHE_ELSE_NETWORK = <span class="number">1</span>;<span class="comment">//如果有缓存,优先加载缓存,否则从网络获取数据</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LOAD_NO_CACHE = <span class="number">2</span>;<span class="comment">//不加载缓存,只从网络获取数据</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LOAD_CACHE_ONLY = <span class="number">3</span>;<span class="comment">//只加载缓存</span></div></pre></td></tr></table></figure></p>
<p>如果加载的是静态页面,网页数据样式固定,则推荐使用<code>LOAD_CACHE_ELSE_NETWORK</code>模式;</p>
<p>如果加载的数据是从服务器动态获取的,比如帖子论坛页面,个人信息页面,则推荐使用<code>LOAD_NO_CACHE</code>,以保证每次都能获取最新内容</p>
<p>如果加载的网页是app端内置于<code>assets</code>目录写死的网页,则可以使用<code>LOAD_CACHE_ONLY</code>模式;</p>
<h5 id="三、关于webview页面输入法弹窗遮挡输入框的问题解决方案"><a href="#三、关于webview页面输入法弹窗遮挡输入框的问题解决方案" class="headerlink" title="三、关于webview页面输入法弹窗遮挡输入框的问题解决方案"></a>三、关于webview页面输入法弹窗遮挡输入框的问题解决方案</h5><p>在<code>Activity</code>的<code>OnCrate()</code>方法中加入如下代码:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.getWindow().setSoftInputMode(</div><div class="line">                WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE |</div><div class="line">                        WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN</div><div class="line">        );</div></pre></td></tr></table></figure></p>
<p>,此段代码含义是输入法高度状态自适应,如果有输入法弹出,则重新调整页面布局使输入框处于输入法上面</p>
<h5 id="四、webview网页加载速度提升"><a href="#四、webview网页加载速度提升" class="headerlink" title="四、webview网页加载速度提升"></a>四、webview网页加载速度提升</h5><p>在开始加载前设置<code>settings.setBlockNetworkImage(true);</code>先屏蔽掉加载网页,然后在<br>设置webview的<code>setWebViewClient()</code>方法里<code>new</code>出新的<code>WebViewClient()</code>时,在重写的方法<code>onPageFinished()</code>中再设置<code>mWebSettings.setBlockNetworkImage(false);</code>取消图片加载屏蔽限制</p>
<h5 id="五、WebView避免内存泄漏"><a href="#五、WebView避免内存泄漏" class="headerlink" title="五、WebView避免内存泄漏"></a>五、WebView避免内存泄漏</h5><ul>
<li>不在xml中定义 Webview ，而是在需要的时候在Activity中创建，并且Context使用 getApplicationgContext()</li>
<li>在 Activity 销毁（ WebView ）的时候，先让 WebView 加载null内容，然后移除 WebView，再销毁 WebView，最后置空。<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (mWebView != <span class="keyword">null</span>) &#123;</div><div class="line">        mWebView.loadDataWithBaseURL(<span class="keyword">null</span>, <span class="string">""</span>, <span class="string">"text/html"</span>, <span class="string">"utf-8"</span>, <span class="keyword">null</span>);</div><div class="line">        mWebView.clearHistory();</div><div class="line"></div><div class="line">        ((ViewGroup) mWebView.getParent()).removeView(mWebView);</div><div class="line">        mWebView.destroy();</div><div class="line">        mWebView = <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">super</span>.onDestroy();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="六、Webview的Cookie处理"><a href="#六、Webview的Cookie处理" class="headerlink" title="六、Webview的Cookie处理"></a>六、<code>Webview</code>的<code>Cookie</code>处理</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 设置浏览器的cookies</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCookies</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (NetCenter.cookies.length() &gt; <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        CookieSyncManager.createInstance(AppApplication.getInstance());</div><div class="line">        CookieManager cookieManager = CookieManager.getInstance();</div><div class="line">        cookieManager.setAcceptCookie(<span class="keyword">true</span>);</div><div class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP)</div><div class="line">        &#123;</div><div class="line">            cookieManager.setAcceptThirdPartyCookies(webView, <span class="keyword">true</span>);<span class="comment">//解决cookie更新失败的问题</span></div><div class="line">        &#125;</div><div class="line">        cookieManager.setCookie(NetCenter.PAGE_URL, NetCenter.cookies);</div><div class="line">        CookieSyncManager.getInstance().sync();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"><span class="comment">/**</span></div><div class="line"> * 清空浏览器的cookies</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clearCookies</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    CookieSyncManager cookieSyncMngr =</div><div class="line">            CookieSyncManager.createInstance(<span class="keyword">this</span>);</div><div class="line">    CookieManager cookieManager = CookieManager.getInstance();</div><div class="line">    cookieManager.removeSessionCookie();<span class="comment">// 移除</span></div><div class="line">    cookieManager.removeAllCookie();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="七、WebChromeClient文件上传处理"><a href="#七、WebChromeClient文件上传处理" class="headerlink" title="七、WebChromeClient文件上传处理"></a>七、WebChromeClient文件上传处理</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">webView.setWebChromeClient(<span class="keyword">new</span> WebChromeClient()</div><div class="line">&#123;</div><div class="line">    <span class="comment">//扩展浏览器上传文件</span></div><div class="line">    <span class="comment">//3.0++版本</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openFileChooser</span><span class="params">(ValueCallback&lt;Uri&gt; uploadMsg, String acceptType)</span></span></div><div class="line">    &#123;</div><div class="line">        </div><div class="line">        openPicForWebClient(uploadMsg);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//3.0--版本</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openFileChooser</span><span class="params">(ValueCallback&lt;Uri&gt; uploadMsg)</span></span></div><div class="line">    &#123;</div><div class="line">        </div><div class="line">        openPicForWebClient(uploadMsg);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openFileChooser</span><span class="params">(ValueCallback&lt;Uri&gt; uploadMsg, String acceptType, String capture)</span></span></div><div class="line">    &#123;</div><div class="line">       </div><div class="line">        openPicForWebClient(uploadMsg);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// For Android &gt; 5.0,移动端需要处理的核心</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onShowFileChooser</span><span class="params">(WebView webView, ValueCallback&lt;Uri[]&gt; uploadMsg, WebChromeClient.FileChooserParams fileChooserParams)</span></span></div><div class="line">    &#123;</div><div class="line">        openPicForWebClient(uploadMsg);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>,上传核心代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Uri uri=...;</div><div class="line">mUploadMessage.onReceiveValue(uri);</div></pre></td></tr></table></figure></p>
<p>,在选择好图片或者文件后调用<code>ValueCallback&lt;Uri&gt; uploadMsg</code>的<code>onReceiveValue</code>传入文件的uri即可上传文件。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;一、webview加载缓慢-如何提高加载使用效率&quot;&gt;&lt;a href=&quot;#一、webview加载缓慢-如何提高加载使用效率&quot; class=&quot;headerlink&quot; title=&quot;一、webview加载缓慢,如何提高加载使用效率?&quot;&gt;&lt;/a&gt;一、webview加载缓慢
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>更改android 4.4以上系统的状态栏和控制栏颜色</title>
    <link href="http://codewang.site/%E6%9B%B4%E6%94%B9android-4-4%E4%BB%A5%E4%B8%8A%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E6%A0%8F%E5%92%8C%E6%8E%A7%E5%88%B6%E6%A0%8F%E9%A2%9C%E8%89%B2.html"/>
    <id>http://codewang.site/更改android-4-4以上系统的状态栏和控制栏颜色.html</id>
    <published>2017-07-03T09:17:44.000Z</published>
    <updated>2017-07-04T04:59:07.216Z</updated>
    
    <content type="html"><![CDATA[<div class="note primary"><p>心灵毒汤: 有时候不努力一把真的不知道什么叫绝望 </p>
</div>
<blockquote class="blockquote-center">这篇文章来介绍如何在java代码中更改系统状态栏和控制栏的颜色。</blockquote>



<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 设置顶部状态栏颜色（此功能仅19版本以上可用）</span></div><div class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">    Window window = getWindow();</div><div class="line">    window.addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);</div><div class="line">    SystemBarTintManager tintManager = <span class="keyword">new</span> SystemBarTintManager(<span class="keyword">this</span>);</div><div class="line">    <span class="comment">// 激活状态栏设置</span></div><div class="line">    tintManager.setStatusBarTintEnabled(<span class="keyword">true</span>);</div><div class="line">    <span class="comment">// 使用颜色资源</span></div><div class="line">    tintManager.setStatusBarTintResource(R.color.button_pressed);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面代码的意思就是</p>
<ol>
<li><p>首先将状态栏的设置为透明，不透明，下面你设置的颜色是没有效果的。</p>
</li>
<li><p>然后再激活状态栏的设置。</p>
</li>
<li><p>给状态栏设置颜色</p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note primary&quot;&gt;&lt;p&gt;心灵毒汤: 有时候不努力一把真的不知道什么叫绝望 &lt;/p&gt;
&lt;/div&gt;
&lt;blockquote class=&quot;blockquote-center&quot;&gt;这篇文章来介绍如何在java代码中更改系统状态栏和控制栏的颜色。&lt;/bl
    
    </summary>
    
      <category term="android" scheme="http://codewang.site/categories/android/"/>
    
    
      <category term="android" scheme="http://codewang.site/tags/android/"/>
    
      <category term="状态栏" scheme="http://codewang.site/tags/%E7%8A%B6%E6%80%81%E6%A0%8F/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://codewang.site/hello-world.html"/>
    <id>http://codewang.site/hello-world.html</id>
    <published>2017-07-03T05:37:33.512Z</published>
    <updated>2017-07-03T05:37:33.513Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
    
    </summary>
    
    
  </entry>
  
</feed>
